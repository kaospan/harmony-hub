import{c as G,d as g,s as h,u as W,r as y,j as e,a as T,X as ge,e as Re,G as Ee,B as S,m as x,L as M,o as b}from"./index-BX1-5uJX.js";import{C as $e}from"./ChordBadge-D8slQnnf.js";import{R as Ue,b as ze,O as je,C as ye,a as Ke,T as Ne,D as ve,P as Oe,d as Ve,e as Be,f as He,g as Qe,u as Ye,h as Ge,i as We,S as xe,c as fe,B as Ze}from"./useSpotifyUser-CFeAagmp.js";import{P as he,E as Xe,f as p}from"./animations-Dk4_xDhh.js";import{I as Je}from"./input-D92xCCDs.js";import{u as C}from"./useQuery-GHdTcwIr.js";import{u as Z}from"./useMutation-D6BUY7Ff.js";import{u as es,a as ss}from"./useSpotifyConnect-DYJZA0Kv.js";import{P as f}from"./providers-TqTXgJ0o.js";import{T as ts,a as as,b as O,c as V}from"./tabs-D_5wiFw9.js";import{A as rs,a as ns,b as is,f as B}from"./formatDistanceToNow-CBRWQ1EU.js";import{a as H}from"./BottomNav-DdksZANf.js";import{S as pe,C as Q}from"./index-C8qaemdP.js";import{L as ls}from"./link-6b8bb0zq.js";import{M as R}from"./music-BxcFe2bf.js";import{C as os,D as cs}from"./disc-3-CudFrOvr.js";import{T as ds}from"./trending-up-DKlj5maF.js";import{C as ms}from"./clock-Cm39k8pq.js";import{H as us}from"./heart-DyKYkRn4.js";import"./index-CEPZ7l09.js";import"./index-BiV5K_eQ.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=G("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=G("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=G("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function ps(s={}){const{user:a}=g(),{limit:r=20}=s;return C({queryKey:["play-history",a==null?void 0:a.id,r],queryFn:async()=>{if(!a)return[];const{data:n,error:i}=await h.from("user_interactions").select(`
          id,
          user_id,
          track_id,
          interaction_type,
          created_at
        `).eq("user_id",a.id).like("interaction_type","play_%").order("created_at",{ascending:!1}).limit(r);return i?(console.warn("Failed to fetch play history:",i),[]):(n||[]).map(d=>({id:d.id,user_id:d.user_id,track_id:d.track_id,provider:"spotify",action:d.interaction_type.replace("play_",""),played_at:d.created_at}))},enabled:!!a})}function gs(){const{user:s}=g();return C({queryKey:["play-stats",s==null?void 0:s.id],queryFn:async()=>{if(!s)return null;const{count:a}=await h.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",s.id).like("interaction_type","play_%");return{totalPlays:a||0,providerCounts:{},recentPlays:0}},enabled:!!s})}function js(){const{user:s}=g();return C({queryKey:["profile",s==null?void 0:s.id],queryFn:async()=>{if(!s)return null;const{data:a,error:r}=await h.from("profiles").select("*").eq("id",s.id).single();if(r)throw r;return a},enabled:!!s})}function ys(){const{user:s}=g();return C({queryKey:["user-providers",s==null?void 0:s.id],queryFn:async()=>{if(!s)return[];const{data:a,error:r}=await h.from("user_providers").select("*").eq("user_id",s.id).order("connected_at",{ascending:!1});if(r)throw r;return a},enabled:!!s})}function Ns(){const{user:s}=g(),a=W();return Z({mutationFn:async r=>{if(!s)throw new Error("Not authenticated");const{data:n,error:i}=await h.from("profiles").update({preferred_provider:r}).eq("id",s.id).select().single();if(i)throw i;return n},onSuccess:()=>{a.invalidateQueries({queryKey:["profile"]})}})}function vs(s){return C({queryKey:["user-interaction-stats",s],queryFn:async()=>{if(!s)return{likes:0,saves:0,shares:0};const[a,r,n]=await Promise.all([h.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",s).eq("interaction_type","like"),h.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",s).eq("interaction_type","save"),h.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",s).eq("interaction_type","share")]);return{likes:a.count||0,saves:r.count||0,shares:n.count||0}},enabled:!!s})}const ws="https://ws.audioscrobbler.com/2.0";function bs(){return"your_lastfm_api_key"}async function A(s,a){try{const r=bs(),n=new URLSearchParams({method:s,api_key:r,format:"json",...a}),i=await fetch(`${ws}?${n}`);if(!i.ok)return console.error(`Last.fm API error: ${i.status}`),null;const d=await i.json();return d.error?(console.error(`Last.fm error ${d.error}: ${d.message}`),null):d}catch(r){return console.error("Last.fm request failed:",r),null}}async function we(s){const a=await A("user.getInfo",{user:s});return(a==null?void 0:a.user)??null}async function _s(s,a="3month",r=10){var i;const n=await A("user.getTopArtists",{user:s,period:a,limit:r.toString()});return((i=n==null?void 0:n.topartists)==null?void 0:i.artist)??[]}async function Cs(s,a="3month",r=10){var i;const n=await A("user.getTopTracks",{user:s,period:a,limit:r.toString()});return((i=n==null?void 0:n.toptracks)==null?void 0:i.track)??[]}async function ks(s,a=20){var n;const r=await A("user.getRecentTracks",{user:s,limit:a.toString()});return((n=r==null?void 0:r.recenttracks)==null?void 0:n.track)??[]}async function Ss(s){var r,n;const a=await A("user.getWeeklyArtistChart",{user:s});return((n=(r=a==null?void 0:a.weeklyartistchart)==null?void 0:r.artist)==null?void 0:n.length)??0}async function Fs(s){if(!s)return null;try{const[a,r,n,i,d]=await Promise.all([we(s),_s(s,"3month",10),Cs(s,"3month",10),ks(s,10),Ss(s)]);if(!a)return null;const F=l=>{var P;if(!l||l.length===0)return;const N=["extralarge","large","medium","small"];for(const E of N){const _=l.find(D=>D.size===E);if(_!=null&&_["#text"])return _["#text"]}return((P=l[0])==null?void 0:P["#text"])||void 0};return{totalScrobbles:parseInt(a.playcount,10)||0,artistCount:parseInt(a.artist_count,10)||0,trackCount:parseInt(a.track_count,10)||0,registeredDate:new Date(parseInt(a.registered.unixtime,10)*1e3),topArtists:r.map(l=>({name:l.name,playcount:parseInt(l.playcount,10)||0,imageUrl:F(l.image)})),topTracks:n.map(l=>({name:l.name,artist:l.artist.name,playcount:parseInt(l.playcount||"0",10)})),recentTracks:i.map(l=>{var N;return{name:l.name,artist:l.artist.name,album:(N=l.album)==null?void 0:N["#text"],playedAt:l.date?new Date(parseInt(l.date.uts,10)*1e3):void 0,imageUrl:F(l.image),nowPlaying:!l.date}}),weeklyArtistCount:d}}catch(a){return console.error("Error fetching Last.fm stats:",a),null}}async function Ps(s,a){if(!await we(a))throw new Error("Last.fm username not found. Please check the username and try again.");const{error:n}=await h.from("user_providers").upsert({user_id:s,provider:"lastfm",provider_user_id:a,access_token:"public",refresh_token:"public",expires_at:new Date(Date.now()+365*24*60*60*1e3).toISOString(),connected_at:new Date().toISOString()},{onConflict:"user_id,provider"});if(n)throw console.error("Failed to store Last.fm connection:",n),new Error("Failed to save Last.fm connection")}async function Ds(s){const{data:a,error:r}=await h.from("user_providers").select("provider_user_id").eq("user_id",s).eq("provider","lastfm").single();return r||!a?null:a.provider_user_id}async function Ls(s){const{error:a}=await h.from("user_providers").delete().eq("user_id",s).eq("provider","lastfm");if(a)throw new Error("Failed to disconnect Last.fm")}function be(){const{user:s}=g();return C({queryKey:["lastfm-username",s==null?void 0:s.id],queryFn:()=>Ds(s.id),enabled:!!s,staleTime:5*60*1e3})}function Ts(){const{user:s}=g(),{data:a}=be();return C({queryKey:["lastfm-stats",a],queryFn:()=>a?Fs(a):null,enabled:!!s&&!!a,staleTime:5*60*1e3,refetchOnWindowFocus:!0})}function As(){const{user:s}=g(),a=W();return Z({mutationFn:async r=>{if(!s)throw new Error("Must be logged in");return await Ps(s.id,r),r},onSuccess:r=>{a.setQueryData(["lastfm-username",s==null?void 0:s.id],r),a.invalidateQueries({queryKey:["lastfm-stats"]}),a.invalidateQueries({queryKey:["user-providers"]})}})}function qs(){const{user:s}=g(),a=W();return Z({mutationFn:async()=>{if(!s)throw new Error("Must be logged in");await Ls(s.id)},onSuccess:()=>{a.setQueryData(["lastfm-username",s==null?void 0:s.id],null),a.setQueryData(["lastfm-stats",null],null),a.invalidateQueries({queryKey:["user-providers"]})}})}const Is=Ue,Ms=ze,Rs=Oe,_e=y.forwardRef(({className:s,...a},r)=>e.jsx(je,{ref:r,className:T("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a}));_e.displayName=je.displayName;const Ce=y.forwardRef(({className:s,children:a,...r},n)=>e.jsxs(Rs,{children:[e.jsx(_e,{}),e.jsxs(ye,{ref:n,className:T("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...r,children:[a,e.jsxs(Ke,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(ge,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ce.displayName=ye.displayName;const ke=({className:s,...a})=>e.jsx("div",{className:T("flex flex-col space-y-1.5 text-center sm:text-left",s),...a});ke.displayName="DialogHeader";const Se=y.forwardRef(({className:s,...a},r)=>e.jsx(Ne,{ref:r,className:T("text-lg font-semibold leading-none tracking-tight",s),...a}));Se.displayName=Ne.displayName;const Es=y.forwardRef(({className:s,...a},r)=>e.jsx(ve,{ref:r,className:T("text-sm text-muted-foreground",s),...a}));Es.displayName=ve.displayName;const $s={energetic:"from-orange-500 to-red-500",chill:"from-blue-400 to-cyan-400",melancholic:"from-purple-500 to-indigo-600",upbeat:"from-yellow-400 to-orange-400",balanced:"from-green-400 to-emerald-500"},Us={energetic:"âš¡",chill:"ðŸŒŠ",melancholic:"ðŸŒ™",upbeat:"â˜€ï¸",balanced:"ðŸŽ¯"},Y={favoriteProgressions:[{progression:["vi","IV","I","V"],count:42},{progression:["I","V","vi","IV"],count:38},{progression:["i","VII","VI","VII"],count:24}],preferredModes:[{mode:"minor",percentage:58},{mode:"major",percentage:42}],energyPreference:.72,cadencePreference:"loop"};function ot(){var oe,ce,de,me;const{user:s,signOut:a,loading:r}=g(),n=Re(),[i,d]=y.useState("all"),[F,l]=y.useState(!1),[N,P]=y.useState(""),[E,_]=y.useState(!1),[D,Fe]=y.useState("medium_term"),{data:c}=js(),{data:L=[],refetch:$}=ys(),{data:X}=gs(),{data:k}=vs(s==null?void 0:s.id),{data:J=[]}=ps({limit:20,provider:i==="all"?void 0:i}),Pe=Ns(),{data:De}=Ve(),{data:m}=Be(),{data:ee=[]}=He(D,10),{data:se=[]}=Qe(D,10),{data:U}=Ye(20),{data:u}=Ge(),{data:te=[]}=We([],[],10),ae=es(),re=ss(),{data:ne}=be(),{data:j}=Ts(),q=As(),z=qs(),K=De===!0,I=!!ne,Le=(k==null?void 0:k.likes)??0,Te=(k==null?void 0:k.saves)??0,Ae=async()=>{await a(),n("/")},qe=async()=>{try{await ae.mutateAsync()}catch(t){b.error(t.message||"Failed to connect Spotify")}},Ie=async()=>{try{await re.mutateAsync(),b.success("Spotify disconnected"),$()}catch{b.error("Failed to disconnect Spotify")}},ie=async()=>{if(!N.trim()){b.error("Please enter your Last.fm username");return}try{await q.mutateAsync(N.trim()),b.success("Last.fm connected successfully!"),_(!1),P(""),$()}catch(t){b.error(t.message||"Failed to connect Last.fm")}},Me=async()=>{try{await z.mutateAsync(),b.success("Last.fm disconnected"),$()}catch{b.error("Failed to disconnect Last.fm")}},le=async t=>{try{await Pe.mutateAsync(t),l(!1)}catch(o){console.error("Failed to set preferred provider:",o)}};return r?e.jsx(Ee,{fullScreen:!0}):s?e.jsxs(he,{title:"Profile",headerActions:e.jsx(S,{variant:"ghost",size:"icon",onClick:Ae,children:e.jsx(fs,{className:"w-5 h-5"})}),children:[e.jsxs(x.div,{variants:p,initial:"initial",animate:"animate",className:"flex items-center gap-4 p-4 glass rounded-2xl",children:[e.jsxs(rs,{className:"w-16 h-16",children:[e.jsx(ns,{src:(m==null?void 0:m.imageUrl)||(c==null?void 0:c.avatar_url)||void 0}),e.jsx(is,{className:"bg-gradient-to-br from-primary to-accent text-white text-xl",children:((oe=m==null?void 0:m.displayName)==null?void 0:oe[0])||((ce=s.email)==null?void 0:ce[0].toUpperCase())||"U"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"font-bold truncate",children:(m==null?void 0:m.displayName)||((de=s.email)==null?void 0:de.split("@")[0])}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s.email}),m&&e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${m.product==="premium"?"bg-[#1DB954]/20 text-[#1DB954]":"bg-muted text-muted-foreground"}`,children:m.product==="premium"?"ðŸ‘‘ Premium":"Free"}),m.followers&&m.followers>0&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[m.followers," followers"]})]})]})]}),e.jsxs(x.div,{variants:p,initial:"initial",animate:"animate",transition:{delay:.05},className:"p-4 glass rounded-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(hs,{className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"font-medium",children:"Credits"})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Free tier"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full w-1/4 bg-gradient-to-r from-primary to-accent rounded-full"})}),e.jsx("span",{className:"text-sm font-medium",children:"25/100"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Credits reset monthly. Used for track analysis."})]}),K&&u&&e.jsxs(x.div,{variants:p,initial:"initial",animate:"animate",transition:{delay:.1},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xs,{className:"w-5 h-5"}),e.jsx("h3",{className:"font-bold",children:"Your Music DNA"})]}),e.jsxs("div",{className:`p-6 rounded-2xl bg-gradient-to-br ${$s[u.moodProfile]} text-white`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("span",{className:"text-4xl",children:Us[u.moodProfile]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold capitalize",children:u.moodProfile}),e.jsx("p",{className:"text-white/80 text-sm",children:"Your listening mood profile"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Energy"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-white/20 rounded-full",children:e.jsx("div",{className:"h-full bg-white rounded-full",style:{width:`${u.averageEnergy*100}%`}})}),e.jsxs("span",{className:"text-sm",children:[Math.round(u.averageEnergy*100),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Danceability"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-white/20 rounded-full",children:e.jsx("div",{className:"h-full bg-white rounded-full",style:{width:`${u.averageDanceability*100}%`}})}),e.jsxs("span",{className:"text-sm",children:[Math.round(u.averageDanceability*100),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Happiness"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-white/20 rounded-full",children:e.jsx("div",{className:"h-full bg-white rounded-full",style:{width:`${u.averageValence*100}%`}})}),e.jsxs("span",{className:"text-sm",children:[Math.round(u.averageValence*100),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Avg Tempo"}),e.jsxs("p",{className:"text-lg font-bold",children:[Math.round(u.averageTempo)," BPM"]})]})]})]}),u.topGenres.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Top Genres"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:u.topGenres.slice(0,8).map((t,o)=>e.jsx("span",{className:"px-3 py-1 rounded-full bg-primary/10 text-primary text-sm",style:{opacity:1-o*.08},children:t.genre},t.genre))})]})]}),e.jsxs(x.div,{variants:p,initial:"initial",animate:"animate",transition:{delay:.12},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5 text-accent"}),e.jsx("h3",{className:"font-bold",children:"Chord Taste DNA"})]}),e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Favorite Progressions"}),Y.favoriteProgressions.map((t,o)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex gap-1",children:t.progression.map((v,w)=>e.jsx($e,{chord:v,size:"sm"},w))}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[t.count," songs"]})]},o))]}),e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Mode Preference"}),e.jsx("div",{className:"flex gap-2",children:Y.preferredModes.map(t=>e.jsxs("div",{className:"flex-1 p-3 rounded-xl bg-muted/50 text-center",children:[e.jsxs("span",{className:"text-lg font-bold",children:[t.percentage,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:t.mode})]},t.mode))})]}),e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Energy Preference"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Low"}),e.jsx("div",{className:"flex-1 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-primary to-accent rounded-full",style:{width:`${Y.energyPreference*100}%`}})}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"High"})]})]})]}),e.jsxs(x.div,{variants:p,initial:"initial",animate:"animate",transition:{delay:.15},className:"space-y-3",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(ls,{className:"w-5 h-5"}),"Connected Services"]}),(()=>{const t=L.find(w=>w.provider==="spotify"),o=ae.isPending,v=re.isPending;return e.jsxs("div",{className:"w-full p-4 glass rounded-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#1DB954]/20 flex items-center justify-center",children:e.jsx(xe,{className:"w-5 h-5 text-[#1DB954]"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"font-medium",children:"Spotify"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t?`Connected ${B(new Date(t.connected_at))} ago`:"Sync your listening history"})]})]}),t?e.jsx(S,{variant:"outline",size:"sm",onClick:Ie,disabled:v,className:"text-destructive hover:text-destructive",children:v?e.jsx(M,{className:"w-4 h-4 animate-spin"}):"Disconnect"}):e.jsx(S,{size:"sm",onClick:qe,disabled:o,className:"bg-[#1DB954] hover:bg-[#1ed760] text-white gap-2",children:o?e.jsx(M,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"w-4 h-4"}),"Connect"]})})]}),t&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-[#1DB954]",children:[e.jsx(Q,{className:"w-3 h-3"}),e.jsx("span",{children:"Syncing your recently played tracks"})]})]})})(),e.jsx("button",{className:"w-full p-4 glass rounded-2xl flex items-center justify-between hover:bg-muted/30 transition-colors",onClick:()=>{},children:(()=>{const t=L.find(o=>o.provider==="youtube");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#FF0000]/20 flex items-center justify-center",children:e.jsx(R,{className:"w-5 h-5 text-[#FF0000]"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"font-medium",children:"YouTube Music"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t?`Connected ${B(new Date(t.connected_at))} ago`:"Coming soon"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t&&e.jsx(Q,{className:"w-4 h-4 text-[#FF0000]"}),e.jsx(os,{className:"w-5 h-5 text-muted-foreground"})]})]})})()}),e.jsxs("div",{className:"w-full p-4 glass rounded-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#D51007]/20 flex items-center justify-center",children:e.jsx(fe,{className:"w-5 h-5 text-[#D51007]"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"font-medium",children:"Last.fm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:I?e.jsxs(e.Fragment,{children:["@",ne," â€¢ ",j==null?void 0:j.totalScrobbles.toLocaleString()," scrobbles"]}):"Connect to see your listening history"})]})]}),I?e.jsx(S,{variant:"outline",size:"sm",onClick:Me,disabled:z.isPending,className:"text-destructive hover:text-destructive",children:z.isPending?e.jsx(M,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-4 h-4 mr-1"}),"Disconnect"]})}):e.jsxs(Is,{open:E,onOpenChange:_,children:[e.jsx(Ms,{asChild:!0,children:e.jsx(S,{size:"sm",className:"bg-[#D51007] hover:bg-[#D51007]/90",children:"Connect"})}),e.jsxs(Ce,{children:[e.jsx(ke,{children:e.jsx(Se,{children:"Connect Last.fm"})}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your Last.fm username to sync your listening history and scrobbles."}),e.jsx(Je,{placeholder:"Your Last.fm username",value:N,onChange:t=>P(t.target.value),onKeyDown:t=>t.key==="Enter"&&ie()}),e.jsxs(S,{onClick:ie,disabled:q.isPending,className:"w-full bg-[#D51007] hover:bg-[#D51007]/90",children:[q.isPending?e.jsx(M,{className:"w-4 h-4 animate-spin mr-2"}):null,q.isPending?"Connecting...":"Connect Last.fm"]})]})]})]})]}),I&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-[#D51007]",children:[e.jsx(Q,{className:"w-3 h-3"}),e.jsx("span",{children:"Syncing your scrobble history"})]})]}),L.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Preferred Provider"}),e.jsx("button",{onClick:()=>l(!F),className:"text-xs text-primary hover:underline",children:"Change"})]}),F?e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>le("none"),className:`w-full p-2 rounded-lg text-left text-sm transition-colors ${!(c!=null&&c.preferred_provider)||c.preferred_provider==="none"?"bg-primary/20 text-primary":"hover:bg-muted/30"}`,children:"No preference"}),L.map(t=>e.jsxs("button",{onClick:()=>le(t.provider),className:`w-full p-2 rounded-lg flex items-center gap-2 text-sm transition-colors ${(c==null?void 0:c.preferred_provider)===t.provider?"bg-primary/20 text-primary":"hover:bg-muted/30"}`,children:[e.jsx("div",{className:"w-6 h-6 rounded flex items-center justify-center text-xs",style:{backgroundColor:`${f[t.provider].color}20`},children:e.jsx("span",{children:f[t.provider].icon})}),f[t.provider].name]},t.id))]}):e.jsx("div",{className:"flex items-center gap-2",children:c!=null&&c.preferred_provider&&c.preferred_provider!=="none"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:`${f[c.preferred_provider].color}20`},children:e.jsx("span",{children:f[c.preferred_provider].icon})}),e.jsx("span",{className:"text-sm font-medium",children:f[c.preferred_provider].name})]}):e.jsx("span",{className:"text-sm text-muted-foreground",children:"No preference set"})})]})]}),K&&e.jsxs(x.div,{variants:p,initial:"initial",animate:"animate",transition:{delay:.17},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(ds,{className:"w-5 h-5"}),"Your Music"]}),e.jsxs("select",{value:D,onChange:t=>Fe(t.target.value),className:"text-xs bg-muted/50 border-none rounded-lg px-2 py-1",children:[e.jsx("option",{value:"short_term",children:"Last 4 weeks"}),e.jsx("option",{value:"medium_term",children:"Last 6 months"}),e.jsx("option",{value:"long_term",children:"All time"})]})]}),e.jsxs(ts,{defaultValue:"tracks",className:"w-full",children:[e.jsxs(as,{className:"w-full",children:[e.jsx(O,{value:"tracks",className:"flex-1",children:"Top Tracks"}),e.jsx(O,{value:"artists",className:"flex-1",children:"Top Artists"}),e.jsx(O,{value:"recent",className:"flex-1",children:"Recent"})]}),e.jsxs(V,{value:"tracks",className:"mt-4 space-y-2",children:[ee.map((t,o)=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/30",children:[e.jsx("span",{className:"w-6 text-center text-muted-foreground text-sm",children:o+1}),e.jsx("div",{className:"w-10 h-10 rounded-lg overflow-hidden bg-muted",children:t.cover_url?e.jsx("img",{src:t.cover_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(R,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:t.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:t.artist})]})]},t.id)),ee.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No top tracks yet"})]}),e.jsxs(V,{value:"artists",className:"mt-4 space-y-2",children:[se.map((t,o)=>{var v,w,ue;return e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/30",children:[e.jsx("span",{className:"w-6 text-center text-muted-foreground text-sm",children:o+1}),e.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-muted",children:(w=(v=t.images)==null?void 0:v[0])!=null&&w.url?e.jsx("img",{src:t.images[0].url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(H,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:t.name}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:(ue=t.genres)==null?void 0:ue.slice(0,2).join(", ")})]})]},t.id)}),se.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No top artists yet"})]}),e.jsx(V,{value:"recent",className:"mt-4 space-y-2",children:((me=U==null?void 0:U.tracks)==null?void 0:me.map(t=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/30",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg overflow-hidden bg-muted",children:t.cover_url?e.jsx("img",{src:t.cover_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(R,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:t.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:t.artist})]})]},t.id)))??e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No recent plays"})})]})]}),K&&te.length>0&&e.jsxs(x.div,{variants:p,initial:"initial",animate:"animate",transition:{delay:.19},className:"space-y-4",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5 text-accent"}),"Recommended For You"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-3",children:te.slice(0,10).map(t=>e.jsxs("div",{className:"p-2 glass rounded-xl hover:bg-muted/30 transition-colors group cursor-pointer",children:[e.jsx("div",{className:"aspect-square rounded-lg overflow-hidden bg-muted mb-2",children:t.cover_url?e.jsx("img",{src:t.cover_url,alt:"",className:"w-full h-full object-cover group-hover:scale-105 transition-transform"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(cs,{className:"w-8 h-8 text-muted-foreground"})})}),e.jsx("p",{className:"font-medium text-xs truncate",children:t.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:t.artist})]},t.id))})]}),I&&j&&e.jsxs(x.div,{variants:p,initial:"initial",animate:"animate",transition:{delay:.21},className:"space-y-4",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5 text-[#D51007]"}),"Last.fm Stats"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-4 glass rounded-2xl text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:j.totalScrobbles.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Scrobbles"})]}),e.jsxs("div",{className:"p-4 glass rounded-2xl text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:j.weeklyArtistCount}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Artists This Week"})]}),e.jsxs("div",{className:"p-4 glass rounded-2xl text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:j.topArtists.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Top Artists"})]})]}),j.topArtists.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Top Artists (3 months)"}),e.jsx("div",{className:"space-y-2",children:j.topArtists.slice(0,5).map((t,o)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-5 text-muted-foreground text-sm",children:o+1}),e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-muted",children:t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(H,{className:"w-3 h-3 text-muted-foreground"})})}),e.jsx("span",{className:"flex-1 text-sm truncate",children:t.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[t.playcount," plays"]})]},t.name))})]})]}),J.length>0&&e.jsxs(x.div,{variants:p,initial:"initial",animate:"animate",transition:{delay:.2},className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(ms,{className:"w-5 h-5"}),"Play History"]}),X&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[X.totalPlays," total plays"]})]}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:[e.jsx("button",{onClick:()=>d("all"),className:`px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap transition-colors ${i==="all"?"bg-primary text-primary-foreground":"bg-muted/50 text-muted-foreground hover:bg-muted"}`,children:"All"}),Object.entries(f).map(([t,o])=>L.some(w=>w.provider===t)?e.jsxs("button",{onClick:()=>d(t),className:`px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap flex items-center gap-1 transition-colors ${i===t?"text-white":"bg-muted/50 text-muted-foreground hover:bg-muted"}`,style:i===t?{backgroundColor:o.color}:{},children:[e.jsx("span",{children:o.icon}),o.name]},t):null)]}),e.jsx("div",{className:"space-y-2",children:J.map(t=>t.track_id?e.jsxs(x.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"p-3 glass rounded-xl flex gap-3 hover:bg-muted/30 transition-colors",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden bg-muted/50 flex-shrink-0",children:e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(R,{className:"w-6 h-6 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-sm truncate",children:"Track"}),e.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:[t.track_id.slice(0,8),"..."]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("span",{className:"px-2 py-0.5 rounded text-xs font-medium flex items-center gap-1",style:{backgroundColor:`${f[t.provider].color}20`,color:f[t.provider].color},children:[e.jsx("span",{className:"text-[10px]",children:f[t.provider].icon}),f[t.provider].name]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:B(new Date(t.played_at),{addSuffix:!0})})]})]})]},t.id):null)})]}),e.jsxs(x.div,{variants:p,initial:"initial",animate:"animate",transition:{delay:.25},className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{className:"p-4 glass rounded-2xl flex flex-col items-center gap-2 hover:bg-muted/30 transition-colors",children:[e.jsx(us,{className:"w-6 h-6 text-accent"}),e.jsx("span",{className:"text-sm font-medium",children:"Liked"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[Le," songs"]})]}),e.jsxs("button",{className:"p-4 glass rounded-2xl flex flex-col items-center gap-2 hover:bg-muted/30 transition-colors",children:[e.jsx(Ze,{className:"w-6 h-6 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Saved"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[Te," songs"]})]})]})]}):e.jsx(he,{title:"Profile",children:e.jsx(Xe,{icon:H,title:"Sign in to see your profile",description:"Track your harmonic taste DNA and saved songs",actionLabel:"Sign in",onAction:()=>n("/auth")})})}export{ot as default};
